The number is 129434
The number is 129435
The number is 129436
The number is 129437
The number is 129438
The number is 129439
The number is 129440
The number is 129441
The number is 129442
The number is 129443
The number is 129444
The number is 129445
The number is 129446
The number is 129447
The number is 129448
The number is 129449
The number is 129450
The number is 129451
The number is 129452
The number is 129453
The number is 129454
The number is 129455
The number is 129456
The number is 129457
The number is 129458
The number is 129459
The number is 129460
The number is 129461
The number is 129462
The number is 129463
The number is 129464
The number is 129465
The number is 129466
The number is 129467
The number is 129468
The number is 129469
The number is 129470
The number is 129471
The number is 129472
The number is 129473
The number is 129474
The number is 129475
The number is 129476
The number is 129477
The number is 129478
The number is 129479
The number is 129480
The number is 129481
The number is 129482
The number is 129483
The number is 129484
The number is 129485
The number is 129486
The number is 129487
The number is 129488
The number is 129489
The number is 129490
The number is 129491
The number is 129492
The number is 129493
The number is 129494
The number is 129495
The number is 129496
The number is 129497
The number is 129498
The number is 129499
The number is 129500
The number is 129501
The number is 129502
The number is 129503
The number is 129504
The number is 129505
The number is 129506
The number is 129507
The number is 129508
The number is 129509
The number is 129510
The number is 129511
The number is 129512
The number is 129513
The number is 129514
The number is 129515
The number is 129516
The number is 129517
The number is 129518
The number is 129519
The number is 129520
The number is 129521
The number is 129522
The number is 129523
The number is 129524
The number is 129525
The number is 129526
The number is 129527
The number is 129528
The number is 129529
The number is 129530
The number is 129531
The number is 129532
The number is 129533
The number is 129534
The number is 129535
The number is 129536
The number is 129537
The number is 129538
The number is 129539
The number is 129540
The number is 129541
The number is 129542
The number is 129543
The number is 129544
The number is 129545
The number is 129546
The number is 129547
The number is 129548
The number is 129549
The number is 129550
The number is 129551
The number is 129552
The number is 129553
The number is 129554
The number is 129555
The number is 129556
The number is 129557
The number is 129558
The number is 129559
The number is 129560
The number is 129561
The number is 129562
The number is 129563
The number is 129564
The number is 129565
The number is 129566
The number is 129567
The number is 129568
The number is 129569
The number is 129570
The number is 129571
The number is 129572
The number is 129573
The number is 129574
The number is 129575
The number is 129576
The number is 129577
The number is 129578
The number is 129579
The number is 129580
The number is 129581
The number is 129582
The number is 129583
The number is 129584
The number is 129585
The number is 129586
The number is 129587
The number is 129588
The number is 129589
The number is 129590
The number is 129591
The number is 129592
The number is 129593
The number is 129594
The number is 129595
The number is 129596
The number is 129597
The number is 129598
The number is 129599
The number is 129600
The number is 129601
The number is 129602
The number is 129603
The number is 129604
The number is 129605
The number is 129606
The number is 129607
The number is 129608
The number is 129609
The number is 129610
The number is 129611
The number is 129612
The number is 129613
The number is 129614
The number is 129615
The number is 129616
The number is 129617
The number is 129618
The number is 129619
The number is 129620
The number is 129621
The number is 129622
The number is 129623
The number is 129624
The number is 129625
The number is 129626
The number is 129627
The number is 129628
The number is 129629
The number is 129630
The number is 129631
The number is 129632
The number is 129633
The number is 129634
The number is 129635
The number is 129636
The number is 129637
The number is 129638
The number is 129639
The number is 129640
The number is 129641
The number is 129642
The number is 129643
The number is 129644
The number is 129645
The number is 129646
The number is 129647
The number is 129648
The number is 129649
The number is 129650
The number is 129651
The number is 129652
The number is 129653
The number is 129654
The number is 129655
The number is 129656
The number is 129657
The number is 129658
The number is 129659
The number is 129660
The number is 129661
The number is 129662
The number is 129663
The number is 129664
The number is 129665
The number is 129666
The number is 129667
The number is 129668
The number is 129669
The number is 129670
The number is 129671
The number is 129672
The number is 129673
The number is 129674
The number is 129675
The number is 129676
The number is 129677
The number is 129678
The number is 129679
The number is 129680
The number is 129681
The number is 129682
The number is 129683
The number is 129684
The number is 129685
The number is 129686
The number is 129687
The number is 129688
The number is 129689
The number is 129690
The number is 129691
The number is 129692
The number is 129693
The number is 129694
The number is 129695
The number is 129696
The number is 129697
The number is 129698
The number is 129699
The number is 129700
The number is 129701
The number is 129702
The number is 129703
The number is 129704
The number is 129705
The number is 129706
The number is 129707
The number is 129708
The number is 129709
The number is 129710
The number is 129711
The number is 129712
The number is 129713
The number is 129714
The number is 129715
The number is 129716
The number is 129717
The number is 129718
The number is 129719
The number is 129720
The number is 129721
The number is 129722
The number is 129723
The number is 129724
The number is 129725
The number is 129726
The number is 129727
The number is 129728
The number is 129729
The number is 129730
The number is 129731
The number is 129732
The number is 129733
The number is 129734
The number is 129735
The number is 129736
The number is 129737
The number is 129738
The number is 129739
The number is 129740
The number is 129741
The number is 129742
The number is 129743
The number is 129744
The number is 129745
The number is 129746
The number is 129747
The number is 129748
The number is 129749
The number is 129750
The number is 129751
The number is 129752
The number is 129753
The number is 129754
The number is 129755
The number is 129756
The number is 129757
The number is 129758
The number is 129759
The number is 129760
The number is 129761
The number is 129762
The number is 129763
The number is 129764
The number is 129765
The number is 129766
The number is 129767
The number is 129768
The number is 129769
The number is 129770
The number is 129771
The number is 129772
The number is 129773
The number is 129774
The number is 129775
The number is 129776
The number is 129777
The number is 129778
The number is 129779
The number is 129780
The number is 129781
The number is 129782
The number is 129783
The number is 129784
The number is 129785
The number is 129786
The number is 129787
The number is 129788
The number is 129789
The number is 129790
The number is 129791
The number is 129792
The number is 129793
The number is 129794
The number is 129795
The number is 129796
The number is 129797
The number is 129798
The number is 129799
The number is 129800
The number is 129801
The number is 129802
The number is 129803
The number is 129804
The number is 129805
The number is 129806
The number is 129807
The number is 129808
The number is 129809
The number is 129810
The number is 129811
The number is 129812
The number is 129813
The number is 129814
The number is 129815
The number is 129816
The number is 129817
The number is 129818
The number is 129819
The number is 129820
The number is 129821
The number is 129822
The number is 129823
The number is 129824
The number is 129825
The number is 129826
The number is 129827
The number is 129828
The number is 129829
The number is 129830
The number is 129831
The number is 129832
The number is 129833
The number is 129834
The number is 129835
The number is 129836
The number is 129837
The number is 129838
The number is 129839
The number is 129840
The number is 129841
The number is 129842
The number is 129843
The number is 129844
The number is 129845
The number is 129846
The number is 129847
The number is 129848
The number is 129849
The number is 129850
The number is 129851
The number is 129852
The number is 129853
The number is 129854
The number is 129855
The number is 129856
The number is 129857
The number is 129858
The number is 129859
The number is 129860
The number is 129861
The number is 129862
The number is 129863
The number is 129864
The number is 129865
The number is 129866
The number is 129867
The number is 129868
The number is 129869
The number is 129870
The number is 129871
The number is 129872
The number is 129873
The number is 129874
The number is 129875
The number is 129876
The number is 129877
The number is 129878
The number is 129879
The number is 129880
The number is 129881
The number is 129882
The number is 129883
The number is 129884
The number is 129885
The number is 129886
The number is 129887
The number is 129888
The number is 129889
The number is 129890
The number is 129891
The number is 129892
The number is 129893
The number is 129894
The number is 129895
The number is 129896
The number is 129897
The number is 129898
The number is 129899
The number is 129900
The number is 129901
The number is 129902
The number is 129903
The number is 129904
The number is 129905
The number is 129906
The number is 129907
The number is 129908
The number is 129909
The number is 129910
The number is 129911
The number is 129912
The number is 129913
The number is 129914
The number is 129915
The number is 129916
The number is 129917
The number is 129918
The number is 129919
The number is 129920
The number is 129921
The number is 129922
The number is 129923
The number is 129924
The number is 129925
The number is 129926
The number is 129927
The number is 129928
The number is 129929
The number is 129930
The number is 129931
The number is 129932
The number is 129933
The number is 129934
The number is 129935
The number is 129936
The number is 129937
The number is 129938
The number is 129939
The number is 129940
The number is 129941
The number is 129942
The number is 129943
The number is 129944
The number is 129945
The number is 129946
The number is 129947
The number is 129948
The number is 129949
The number is 129950
The number is 129951
The number is 129952
The number is 129953
The number is 129954
The number is 129955
The number is 129956
The number is 129957
The number is 129958
The number is 129959
The number is 129960
The number is 129961
The number is 129962
The number is 129963
The number is 129964
The number is 129965
The number is 129966
The number is 129967
The number is 129968
The number is 129969
The number is 129970
The number is 129971
The number is 129972
The number is 129973
The number is 129974
The number is 129975
The number is 129976
The number is 129977
The number is 129978
The number is 129979
The number is 129980
The number is 129981
The number is 129982
The number is 129983
The number is 129984
The number is 129985
The number is 129986
The number is 129987
The number is 129988
The number is 129989
The number is 129990
The number is 129991
The number is 129992
The number is 129993
The number is 129994
The number is 129995
The number is 129996
The number is 129997
The number is 129998
The number is 129999
The number is 130000
The number is 130001
The number is 130002
The number is 130003
The number is 130004
The number is 130005
The number is 130006
The number is 130007
The number is 130008
The number is 130009
The number is 130010
The number is 130011
The number is 130012
The number is 130013
The number is 130014
The number is 130015
The number is 130016
The number is 130017
The number is 130018
The number is 130019
The number is 130020
The number is 130021
The number is 130022
The number is 130023
The number is 130024
The number is 130025
The number is 130026
The number is 130027
The number is 130028
The number is 130029
The number is 130030
The number is 130031
The number is 130032
The number is 130033
The number is 130034
The number is 130035
The number is 130036
The number is 130037
The number is 130038
The number is 130039
The number is 130040
The number is 130041
The number is 130042
The number is 130043
The number is 130044
The number is 130045
The number is 130046
The number is 130047
The number is 130048
The number is 130049
The number is 130050
The number is 130051
The number is 130052
The number is 130053
The number is 130054
The number is 130055
The number is 130056
The number is 130057
The number is 130058
The number is 130059
The number is 130060
The number is 130061
The number is 130062
The number is 130063
The number is 130064
The number is 130065
The number is 130066
The number is 130067
The number is 130068
The number is 130069
The number is 130070
The number is 130071
The number is 130072
The number is 130073
The number is 130074
The number is 130075
The number is 130076
The number is 130077
The number is 130078
The number is 130079
The number is 130080
The number is 130081
The number is 130082
The number is 130083
The number is 130084
The number is 130085
The number is 130086
The number is 130087
The number is 130088
The number is 130089
The number is 130090
The number is 130091
The number is 130092
The number is 130093
The number is 130094
The number is 130095
The number is 130096
The number is 130097
The number is 130098
The number is 130099
The number is 130100
The number is 130101
The number is 130102
The number is 130103
The number is 130104
The number is 130105
The number is 130106
The number is 130107
The number is 130108
The number is 130109
The number is 130110
The number is 130111
The number is 130112
The number is 130113
The number is 130114
The number is 130115
The number is 130116
The number is 130117
The number is 130118
The number is 130119
The number is 130120
The number is 130121
The number is 130122
The number is 130123
The number is 130124
The number is 130125
The number is 130126
The number is 130127
The number is 130128
The number is 130129
The number is 130130
The number is 130131
The number is 130132
The number is 130133
The number is 130134
The number is 130135
The number is 130136
The number is 130137
The number is 130138
The number is 130139
The number is 130140
The number is 130141
The number is 130142
The number is 130143
The number is 130144
The number is 130145
The number is 130146
The number is 130147
The number is 130148
The number is 130149
The number is 130150
The number is 130151
The number is 130152
The number is 130153
The number is 130154
The number is 130155
The number is 130156
The number is 130157
The number is 130158
The number is 130159
The number is 130160
The number is 130161
The number is 130162
The number is 130163
The number is 130164
The number is 130165
The number is 130166
The number is 130167
The number is 130168
The number is 130169
The number is 130170
The number is 130171
The number is 130172
The number is 130173
The number is 130174
The number is 130175
The number is 130176
The number is 130177
The number is 130178
The number is 130179
The number is 130180
The number is 130181
The number is 130182
The number is 130183
The number is 130184
The number is 130185
The number is 130186
The number is 130187
The number is 130188
The number is 130189
The number is 130190
The number is 130191
The number is 130192
The number is 130193
The number is 130194
The number is 130195
The number is 130196
The number is 130197
The number is 130198
The number is 130199
The number is 130200
The number is 130201
The number is 130202
The number is 130203
The number is 130204
The number is 130205
The number is 130206
The number is 130207
The number is 130208
The number is 130209
The number is 130210
The number is 130211
The number is 130212
The number is 130213
The number is 130214
The number is 130215
The number is 130216
The number is 130217
The number is 130218
The number is 130219
The number is 130220
The number is 130221
The number is 130222
The number is 130223
The number is 130224
The number is 130225
The number is 130226
The number is 130227
The number is 130228
The number is 130229
The number is 130230
The number is 130231
The number is 130232
The number is 130233
The number is 130234
The number is 130235
The number is 130236
The number is 130237
The number is 130238
The number is 130239
The number is 130240
The number is 130241
The number is 130242
The number is 130243
The number is 130244
The number is 130245
The number is 130246
The number is 130247
The number is 130248
The number is 130249
The number is 130250
The number is 130251
The number is 130252
The number is 130253
The number is 130254
The number is 130255
The number is 130256
The number is 130257
The number is 130258
The number is 130259
The number is 130260
The number is 130261
The number is 130262
The number is 130263
The number is 130264
The number is 130265
The number is 130266
The number is 130267
The number is 130268
The number is 130269
The number is 130270
The number is 130271
The number is 130272
The number is 130273
The number is 130274
The number is 130275
The number is 130276
The number is 130277
The number is 130278
The number is 130279
The number is 130280
The number is 130281
The number is 130282
The number is 130283
The number is 130284
The number is 130285
The number is 130286
The number is 130287
The number is 130288
The number is 130289
The number is 130290
The number is 130291
The number is 130292
The number is 130293
The number is 130294
The number is 130295
The number is 130296
The number is 130297
The number is 130298
The number is 130299
The number is 130300
The number is 130301
The number is 130302
The number is 130303
The number is 130304
The number is 130305
The number is 130306
The number is 130307
The number is 130308
The number is 130309
The number is 130310
The number is 130311
The number is 130312
The number is 130313
The number is 130314
The number is 130315
The number is 130316
The number is 130317
The number is 130318
The number is 130319
The number is 130320
The number is 130321
The number is 130322
The number is 130323
The number is 130324
The number is 130325
The number is 130326
The number is 130327
The number is 130328
The number is 130329
The number is 130330
The number is 130331
The number is 130332
The number is 130333
The number is 130334
The number is 130335
The number is 130336
The number is 130337
The number is 130338
The number is 130339
The number is 130340
The number is 130341
The number is 130342
The number is 130343
The number is 130344
The number is 130345
The number is 130346
The number is 130347
The number is 130348
The number is 130349
The number is 130350
The number is 130351
The number is 130352
The number is 130353
The number is 130354
The number is 130355
The number is 130356
The number is 130357
The number is 130358
The number is 130359
The number is 130360
The number is 130361
The number is 130362
The number is 130363
The number is 130364
The number is 130365
The number is 130366
The number is 130367
The number is 130368
The number is 130369
The number is 130370
The number is 130371
The number is 130372
The number is 130373
The number is 130374
The number is 130375
The number is 130376
The number is 130377
The number is 130378
The number is 130379
The number is 130380
The number is 130381
The number is 130382
The number is 130383
The number is 130384
The number is 130385
The number is 130386
The number is 130387
The number is 130388
The number is 130389
The number is 130390
The number is 130391
The number is 130392
The number is 130393
The number is 130394
The number is 130395
The number is 130396
The number is 130397
The number is 130398
The number is 130399
The number is 130400
The number is 130401
The number is 130402
The number is 130403
The number is 130404
The number is 130405
The number is 130406
The number is 130407
The number is 130408
The number is 130409
The number is 130410
The number is 130411
The number is 130412
The number is 130413
The number is 130414
The number is 130415
The number is 130416
The number is 130417
The number is 130418
The number is 130419
The number is 130420
The number is 130421
The number is 130422
The number is 130423
The number is 130424
The number is 130425
The number is 130426
The number is 130427
The number is 130428
The number is 130429
The number is 130430
The number is 130431
The number is 130432
The number is 130433
The number is 130434
The number is 130435
The number is 130436
The number is 130437
The number is 130438
The number is 130439
The number is 130440
The number is 130441
The number is 130442
The number is 130443
The number is 130444
The number is 130445
The number is 130446
The number is 130447
The number is 130448
The number is 130449
The number is 130450
The number is 130451
The number is 130452
The number is 130453
The number is 130454
The number is 130455
The number is 130456
The number is 130457
The number is 130458
The number is 130459
The number is 130460
The number is 130461
The number is 130462
The number is 130463
The number is 130464
The number is 130465
The number is 130466
The number is 130467
The number is 130468
The number is 130469
The number is 130470
The number is 130471
The number is 130472
The number is 130473
The number is 130474
The number is 130475
The number is 130476
The number is 130477
The number is 130478
The number is 130479
The number is 130480
The number is 130481
The number is 130482
The number is 130483
The number is 130484
The number is 130485
The number is 130486
The number is 130487
The number is 130488
The number is 130489
The number is 130490
The number is 130491
The number is 130492
The number is 130493
The number is 130494
The number is 130495
The number is 130496
The number is 130497
The number is 130498
The number is 130499
The number is 130500
The number is 130501
The number is 130502
The number is 130503
The number is 130504
The number is 130505
The number is 130506
The number is 130507
The number is 130508
The number is 130509
The number is 130510
The number is 130511
The number is 130512
The number is 130513
The number is 130514
The number is 130515
The number is 130516
The number is 130517
The number is 130518
The number is 130519
The number is 130520
The number is 130521
The number is 130522
The number is 130523
The number is 130524
The number is 130525
The number is 130526
The number is 130527
The number is 130528
The number is 130529
The number is 130530
The number is 130531
The number is 130532
The number is 130533
The number is 130534
The number is 130535
The number is 130536
The number is 130537
The number is 130538
The number is 130539
The number is 130540
The number is 130541
The number is 130542
The number is 130543
The number is 130544
The number is 130545
The number is 130546
The number is 130547
The number is 130548
The number is 130549
The number is 130550
The number is 130551
The number is 130552
The number is 130553
The number is 130554
The number is 130555
java.util.concurrent.TimeoutException: 1 second
  at timeout @ rs$line$7$.<clinit>(rs$line$7:1)
  at timeout @ rs$line$7$.<clinit>(rs$line$7:1)
  at unsafeRunSync @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$8$.<clinit>(rs$line$8:1)

scala> Stream("Mao", "Owl").evalMap(catName => IO.println(s"He
llo $catName"))
val res15: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> res15.compile.count
val res16: cats.effect.IO[Long] = IO(...)

scala> res16.unsafeRunSync()
Hello Mao
Hello Owl
val res17: Long = 2

scala> :q
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
[error] ./scala/Part2HandlingSideEffects/Fig1Effects.scala:9:5
[error] Found:    cats.effect.IO[Long]
[error] Required: cats.effect.IO[Unit]
Error compiling project (Scala 3.7.0, JVM (21))
Compilation failed
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Hi Mao!
Hi Owl!
λ> scala-cli repl project.scala
Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM)
.
Type in expressions for evaluation. Or try :help.

scala> import cats.effect.*
     | import cats.effect.unsafe.implicits.global
     |
import fs2~

scala> import fs2.*

scala> Stream.eval(IO.println("Hello"))
val res0: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> import scala.concurrent.duration.*

scala> IO.sleep(1.second)
val res1: cats.effect.IO[Unit] = IO(...)

scala> res1.unsafeRunSync()

scala> Stream.eval(IO.sleep(1.second)).compile.count
val res2: cats.effect.IO[Long] = IO(...)

scala> res2.unsafeRunSync()
val res3: Long = 1

scala> :q
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
λ> scala-cli repl project.scala
Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM)
.
Type in expressions for evaluation. Or try :help.

scala> import fs2.*
     | import cats.effect.*
     |


scala>

scala> import scala.concurrent.duration.*
     |

scala> Stream.eval(IO.sleep(1.second)).compile
val res0: fs2.Stream.CompileOps[cats.effect.IO, cats.effect.IO
, Unit] = fs2.Stream$CompileOps@1643e817

scala> Stream.eval(IO.sleep(1.second)).compile.count
val res1: cats.effect.IO[Long] = IO(...)

scala> Stream.eval(IO.sleep(1.second)).compile.drain
val res2: cats.effect.IO[Unit] = IO(...)

scala> Stream.exec(IO.sleep(1.second))
val res3: fs2.Stream[cats.effect.IO, Nothing] = Stream(..)

scala> Stream.exec(IO.println("Mao"))
val res4: fs2.Stream[cats.effect.IO, Nothing] = Stream(..)

scala> Stream.exec(IO.println("Mao")).compile.drain
val res5: cats.effect.IO[Unit] = IO(...)

scala> res5.unsafeRunSync()
-- [E172] Type Error: ----------------------------------------
------------------
1 |res5.unsafeRunSync()
  |                    ^
  |Could not find an implicit IORuntime.
  |
  |Instead of calling unsafe methods directly, consider using
cats.effect.IOApp, which
  |runs your IO. If integrating with non-functional code or ex
perimenting in a REPL / Worksheet,
  |add the following import:
  |
  |import cats.effect.unsafe.implicits.global
  |
  |Alternatively, you can create an explicit IORuntime value a
nd put it in implicit scope.
  |This may be useful if you have a pre-existing fixed thread
pool and/or scheduler which you
  |wish to use to execute IO programs. Please be sure to revie
w thread pool best practices to
  |avoid unintentionally degrading your application performanc
e.
  |
  |
  |The following import might fix the problem:
  |
  |  import cats.effect.unsafe.implicits.global
  |
1 error found

scala> import cats.effect.unsafe.implicits.global

scala> res5.unsafeRunSync()
Mao

scala>     Stream.exec(IO.println("Mao"))
     |
val res6: fs2.Stream[cats.effect.IO, Nothing] = Stream(..)

scala> Stream.eval(IO.println("Mao"))
val res7: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> :q
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Mao
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Mao
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Mao
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
n1
n2
Non-daemon threads currently preventing JVM termination: - 44:
 Thread[#44,DestroyJavaVM,5,main]
 -  - 38: Thread[#38,AWT-Shutdown,5,system]
λ> scala-cli repl project.scala

Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM)
.
Type in expressions for evaluation. Or try :help.


scala>

scala> import fs2.*
     | import cats.effect.*
     |

scala> Stream(1,2,3).debugChunks().compile.toList
Chunk(1, 2, 3)
val res0: List[Int] = List(1, 2, 3)

scala> :q
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Food
Chocolate
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Croissant
Coffee
Water
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Orange
Apple
Banan
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
A
B
C
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
A
B
C
D
E
λ> D
bash: D: command not found
E
λ> E
bash: E: command not found
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scal
a scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
What is your favourite food?
Chocolate
What is your favourite food?
Chocolate!
What is your favourite food?
CHOCOLATE!!!
λ> scala-cli repl project.scala
Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM)
.
Type in expressions for evaluation. Or try :help.

scala> Stream("a", "b", "c").reduce
there was 1 deprecation warning; re-run with -deprecation for
details
1 warning found
val res0: ((String, String) => String) => String = Lambda/0x00
00000124580c10@2dfab167

scala> import fs2.*

scala> Stream("a", "b", "c").fold
val res1: Any => ((Any, String) => Any) => fs2.Stream[[x] =>>
fs2.Pure[x], Any] = Lambda/0x00000001245e4c10@6ca1c156

scala> Stream("a", "b", "c").fold(0)((prev, text) => prev + 1)

val res2: fs2.Stream[[x] =>> fs2.Pure[x], Int] = Stream(..)

scala> res2.compile.last
val res3: Option[Int] = Some(3)

scala> import cats.effect.IO
     |

scala> import cats.effect.Ref
     | import cats.effect.unsafe.implicits.global
     |

scala> Ref.of[IO, Int](42)
val res4: cats.effect.IO[cats.effect.kernel.Ref[cats.effect.IO
, Int]] = IO(...)

scala> res4.unsafeRunSync()
val res5: cats.effect.kernel.Ref[cats.effect.IO, Int] = cats.e
ffect.kernel.SyncRef@113773b5

scala> counter = Ref.of[IO, Int](42).unsafeRunSync()
-- [E006] Not Found Error: -----------------------------------
------------------
1 |counter = Ref.of[IO, Int](42).unsafeRunSync()
  |^^^^^^^
  |Not found: counter
  |
  | longer explanation available when compiling with `-explain
`
1 error found

scala> val counter = Ref.of[IO, Int](42).unsafeRunSync()
val counter: cats.effect.kernel.Ref[cats.effect.IO, Int] = cat
s.effect.kernel.SyncRef@53339642

scala> counter.get
val res6: cats.effect.IO[Int] = IO(...)

scala> counter.get.unsafeRunSync()
val res7: Int = 42

scala> Ref.of[IO, Int](42)
val res8: cats.effect.IO[cats.effect.kernel.Ref[cats.effect.IO
, Int]] = IO(...)

scala> Ref.of[IO, Int](42).flatMap(counter => counter.get)
val res9: cats.effect.IO[Int] = IO(...)

scala> res9
val res10: cats.effect.IO[Int] = IO(...)

scala> res9.unsafeRunSync()
val res11: Int = 42

scala> counter
val res12: cats.effect.kernel.Ref[cats.effect.IO, Int] = cats.
effect.kernel.SyncRef@53339642

scala> val getIO = counter.get
val getIO: cats.effect.IO[Int] = IO(...)

scala> getIO.unsafeRunSync()
val res13: Int = 42

def set(a: A): F[Unit]

scala> counter.set(33)
val res14: cats.effect.IO[Unit] = IO(...)

scala> getIO.unsafeRunSync()
val res15: Int = 42

scala> counter.set(33).unsafeRunSync()

scala> getIO.unsafeRunSync()
val res16: Int = 33

scala> counter.update(prev => prev + 1)
val res17: cats.effect.IO[Unit] = IO(...)

scala> res17.unsafeRunSync()

scala> getIO.unsafeRunSync()
val res18: Int = 34

scala> res17.unsafeRunSync()

scala> getIO.unsafeRunSync()
val res19: Int = 35

scala>
scala> val incrementEverySecond =
     |   Stream.eval(counter.update(_ + 1))
     |     .repeat.spaced(1.second)
     |

-- [E008] Not Found Error: -----------------------------------
------------------
3 |    .repeat.spaced(1.second)
  |                   ^^^^^^^^
  |value second is not a member of Int, but could be made avai
lable as an extension method.
  |
  |The following import might fix the problem:
  |
  |  import scala.concurrent.duration.DurationInt
  |
1 error found

scala>

scala> import scala.concurrent.duration.*

scala> val incrementEverySecond =
     |   Stream.eval(counter.update(_ + 1))
     |     .repeat.spaced(1.second)
     |
val incrementEverySecond: fs2.Stream[cats.effect.IO, Unit] = S
tream(..)

scala> incrementEverySecond.compile.drain.timeout(5.seconds)
val res20: cats.effect.IO[Unit] = IO(...)

scala> res20.unsafeRunSync()
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)

scala> getIO.unsafeRunSync()
val res22: Int = 40

scala> counter.get.flatMap(IO.println)
val res23: cats.effect.IO[Unit] = IO(...)

scala> res23.unsafeRunSync()
40

scala> val printCountIO = counter.get.flatMap(n => IO.println(
s"The number is $n"))
val printCountIO: cats.effect.IO[Unit] = IO(...)

scala> printCountIO.unsafeRunSync()
The number is 40

scala> Stream.eval(printCountIO).repeat.spaced(500.millis)
val res24: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> res24.compile.drain.timeout(5.seconds)
val res25: cats.effect.IO[Unit] = IO(...)

scala> res25.unsafeRunSync()
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)

scala> val printTwicePerSecond =
     |   Stream.eval(printCountIO).repeat.spaced(500.millis)
     |
val printTwicePerSecond: fs2.Stream[cats.effect.IO, Unit] = St
ream(..)


scala> Stream(incrementEverySecond, printTwicePerSecond).parJo
inUnbounded
val res27: fs2.Stream[cats.effect.IO, Unit] = Stream(..)


scala> res27.compile.drain.timeout(5.seconds)
val res28: cats.effect.IO[Unit] = IO(...)


scala> res28.unsafeRunSync()
The number is 40
The number is 41
The number is 42
The number is 42
The number is 43
The number is 43
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)

scala> import fs2.concurrent.*
     |

scala> SignallingRef
     |   .of[IO, Int](0)
     |
val res30: cats.effect.IO[fs2.concurrent.SignallingRef[cats.ef
fect.IO, Int]] = IO(...)

scala> res30.unsafeRunSync()
val res31: fs2.concurrent.SignallingRef[cats.effect.IO, Int] =
 fs2.concurrent.SignallingRef$$anon$4@67749a7e

scala> res31.get.unsafeRunSync()

  unhandled exception while running pickler on rs$line$48

  An unhandled exception was thrown in the compiler.
  Please file a crash report here:
  https://github.com/scala/scala3/issues/new/choose
  For non-enriched exceptions, compile with -Xno-enrich-error-
messages.


     while compiling: rs$line$48
        during phase: pickler
                mode: Mode(ImplicitsEnabled,ReadPositions,Inte
ractive)
     library version: version 2.13.16
    compiler version: version 3.7.0
            settings: -Xcook-docs true -Xread-docs true -class
path /Users/zainab/dev/zainab-ali/functional-stream-processing
-workshop/.scala-build/functional-stream-processing-workshop_1
628ab5c8e-f9b87170bb/classes/main:/Users/zainab/Library/Caches
/Coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala
3-library_3/3.7.0/scala3-library_3-3.7.0.jar:/Users/zainab/Lib
rary/Caches/Coursier/v1/https/repo1.maven.org/maven2/com/githu
b/zainab-ali/aquascape_3/0.4.0/aquascape_3-0.4.0.jar:/Users/za
inab/Library/Caches/Coursier/v1/https/repo1.maven.org/maven2/c
o/fs2/fs2-core_3/3.12.0/fs2-core_3-3.12.0.jar:/Users/zainab/Li
brary/Caches/Coursier/v1/https/repo1.maven.org/maven2/co/fs2/f
s2-io_3/3.12.0/fs2-io_3-3.12.0.jar:/Users/zainab/Library/Cache
s/Coursier/v1/https/repo1.maven.org/maven2/com/lihaoyi/scalata
gs_3/0.13.1/scalatags_3-0.13.1.jar:/Users/zainab/Library/Cache
s/Coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scal
a-library/2.13.16/scala-library-2.13.16.jar:/Users/zainab/Libr
ary/Caches/Coursier/v1/https/repo1.maven.org/maven2/org/creati
vescala/doodle-core_3/0.30.0/doodle-core_3-0.30.0.jar:/Users/z
ainab/Library/Caches/Coursier/v1/https/repo1.maven.org/maven2/
org/typelevel/cats-core_3/2.13.0/cats-core_3-2.13.0.jar:/Users
/zainab/Library/Caches/Coursier/v1/https/repo1.maven.org/maven
2/org/typelevel/cats-effect_3/3.6.1/cats-effect_3-3.6.1.jar:/U
sers/zainab/Library/Caches/Coursier/v1/https/repo1.maven.org/m
aven2/org/creativescala/doodle-java2d_3/0.30.0/doodle-java2d_3
-0.30.0.jar:/Users/zainab/Library/Caches/Coursier/v1/https/rep
o1.maven.org/maven2/com/monovore/decline_3/2.5.0/decline_3-2.5
.0.jar:/Users/zainab/Library/Caches/Coursier/v1/https/repo1.ma
ven.org/maven2/org/scodec/scodec-bits_3/1.1.38/scodec-bits_3-1
.1.38.jar:/Users/zainab/Library/Caches/Coursier/v1/https/repo1
.maven.org/maven2/com/comcast/ip4s-core_3/3.6.0/ip4s-core_3-3.
6.0.jar:/Users/zainab/Library/Caches/Coursier/v1/https/repo1.m
aven.org/maven2/com/lihaoyi/sourcecode_3/0.4.0/sourcecode_3-0.
4.0.jar:/Users/zainab/Library/Caches/Coursier/v1/https/repo1.m
aven.org/maven2/com/lihaoyi/geny_3/1.1.0/geny_3-1.1.0.jar:/Use
rs/zainab/Library/Caches/Coursier/v1/https/repo1.maven.org/mav
en2/org/typelevel/cats-free_3/2.13.0/cats-free_3-2.13.0.jar:/U
sers/zainab/Library/Caches/Coursier/v1/https/repo1.maven.org/m
aven2/org/typelevel/cats-kernel_3/2.13.0/cats-kernel_3-2.13.0.
jar:/Users/zainab/Library/Caches/Coursier/v1/https/repo1.maven
.org/maven2/org/typelevel/cats-effect-kernel_3/3.6.1/cats-effe
ct-kernel_3-3.6.1.jar:/Users/zainab/Library/Caches/Coursier/v1
/https/repo1.maven.org/maven2/org/typelevel/cats-effect-std_3/
3.6.1/cats-effect-std_3-3.6.1.jar:/Users/zainab/Library/Caches
/Coursier/v1/https/repo1.maven.org/maven2/org/typelevel/cats-m
tl_3/1.3.1/cats-mtl_3-1.3.1.jar:/Users/zainab/Library/Caches/C
oursier/v1/https/repo1.maven.org/maven2/org/creativescala/dood
le-algebra_3/0.30.0/doodle-algebra_3-0.30.0.jar:/Users/zainab/
Library/Caches/Coursier/v1/https/repo1.maven.org/maven2/org/cr
eativescala/doodle-interact_3/0.30.0/doodle-interact_3-0.30.0.
jar:/Users/zainab/Library/Caches/Coursier/v1/https/repo1.maven
.org/maven2/de/erichseifert/vectorgraphics2d/VectorGraphics2D/
0.13/VectorGraphics2D-0.13.jar:/Users/zainab/Library/Caches/Co
ursier/v1/https/repo1.maven.org/maven2/org/typelevel/literally
_3/1.1.0/literally_3-1.1.0.jar -d <REPL compilation output>

Exception in thread "main" java.lang.OutOfMemoryError: Java he
ap space
        at dotty.tools.dotc.util.PerfectHashing.allocate(Perfe
ctHashing.scala:36)
        at dotty.tools.dotc.util.IntMap.allocate(IntMap.scala:
29)
        at dotty.tools.dotc.util.PerfectHashing.clear(PerfectH
ashing.scala:45)
        at dotty.tools.dotc.util.PerfectHashing.<init>(Perfect
Hashing.scala:31)
        at dotty.tools.dotc.util.IntMap.<init>(IntMap.scala:23
)
        at dotty.tools.dotc.core.tasty.TreeBuffer.<init>(TreeB
uffer.scala:24)
        at dotty.tools.dotc.core.tasty.TreePickler.<init>(Tree
Pickler.scala:28)
        at dotty.tools.dotc.transform.Pickler.run$$anonfun$1$$
anonfun$1(Pickler.scala:303)
        at dotty.tools.dotc.transform.Pickler$$Lambda/0x000000
01244a8000.applyVoid(Unknown Source)
        at scala.runtime.function.JProcedure1.apply(JProcedure
1.java:15)
        at scala.runtime.function.JProcedure1.apply(JProcedure
1.java:10)
        at scala.collection.immutable.List.foreach(List.scala:
334)
        at dotty.tools.dotc.transform.Pickler.run$$anonfun$1(P
ickler.scala:279)
        at dotty.tools.dotc.transform.Pickler$$Lambda/0x000000
01244a7ae8.applyVoid(Unknown Source)
        at scala.runtime.function.JProcedure1.apply(JProcedure
1.java:15)
        at scala.runtime.function.JProcedure1.apply(JProcedure
1.java:10)
        at scala.collection.immutable.List.foreach(List.scala:
334)
        at dotty.tools.dotc.transform.Pickler.run(Pickler.scal
a:278)
        at dotty.tools.dotc.core.Phases$Phase.runOn$$anonfun$1
(Phases.scala:383)
        at dotty.tools.dotc.core.Phases$Phase$$Lambda/0x000000
0124354408.applyVoid(Unknown Source)
        at scala.runtime.function.JProcedure1.apply(JProcedure
1.java:15)
        at scala.runtime.function.JProcedure1.apply(JProcedure
1.java:10)
        at scala.collection.immutable.List.foreach(List.scala:
334)
        at dotty.tools.dotc.core.Phases$Phase.runOn(Phases.sca
la:376)
        at dotty.tools.dotc.transform.Pickler.runPhase$1(Pickl
er.scala:392)
        at dotty.tools.dotc.transform.Pickler.runOn(Pickler.sc
ala:398)
        at dotty.tools.dotc.Run.runPhases$1$$anonfun$1(Run.sca
la:367)
        at dotty.tools.dotc.Run$$Lambda/0x0000000124354000.app
lyVoid(Unknown Source)
        at scala.runtime.function.JProcedure1.apply(JProcedure
1.java:15)
        at scala.runtime.function.JProcedure1.apply(JProcedure
1.java:10)
        at scala.collection.ArrayOps$.foreach$extension(ArrayO
ps.scala:1324)
        at dotty.tools.dotc.Run.runPhases$1(Run.scala:360)
λ> scala-cli repl project.scala
Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM)
.
Type in expressions for evaluation. Or try :help.

scala> import fs2.concurrent.*
     |

scala> import cats.effect.IO
     | import cats.effect.Ref
     |

scala> SignallingRef
     |   .of[IO, Int](0).unsafeRunSync()
-- [E172] Type Error: ----------------------------------------
------------------
2 |  .of[IO, Int](0).unsafeRunSync()
  |                                 ^
  |Could not find an implicit IORuntime.
  |
  |Instead of calling unsafe methods directly, consider using
cats.effect.IOApp, which
  |runs your IO. If integrating with non-functional code or ex
perimenting in a REPL / Worksheet,
  |add the following import:
  |
  |import cats.effect.unsafe.implicits.global
  |
  |Alternatively, you can create an explicit IORuntime value a
nd put it in implicit scope.
  |This may be useful if you have a pre-existing fixed thread
pool and/or scheduler which you
  |wish to use to execute IO programs. Please be sure to revie
w thread pool best practices to
  |avoid unintentionally degrading your application performanc
e.
  |
  |
  |The following import might fix the problem:
  |
  |  import cats.effect.unsafe.implicits.global
  |
1 error found

scala> import cats.effect.unsafe.implicits.global
     |

scala> SignallingRef
     |   .of[IO, Int](0).unsafeRunSync()
val res0: fs2.concurrent.SignallingRef[cats.effect.IO, Int] =
fs2.concurrent.SignallingRef$$anon$4@4f8efd72

scala> res0.discrete
val res1: fs2.Stream[cats.effect.IO, Int] = Stream(..)

scala> val counter =
     | SignallingRef
     |   .of[IO, Int](0).unsafeRunSync()
val counter: fs2.concurrent.SignallingRef[cats.effect.IO, Int]
 = fs2.concurrent.SignallingRef$$anon$4@349c64a1

scala>     val incrementEverySecond =
     |       Stream.repeatEval(counter.update(_ + 1)).spaced(1
.second)
     |
-- [E008] Not Found Error: -----------------------------------
------------------
2 |      Stream.repeatEval(counter.update(_ + 1)).spaced(1.sec
ond)
  |      ^^^^^^^^^^^^^^^^^
  |value repeatEval is not a member of object scala.collection
.immutable.Stream
1 error found

scala> import fs2.*

scala> val counter =
     | SignallingRef
     |   .of[IO, Int](0).unsafeRunSync()
val counter: fs2.concurrent.SignallingRef[cats.effect.IO, Int]
 = fs2.concurrent.SignallingRef$$anon$4@245f90a6

scala>     val incrementEverySecond =
     |       Stream.repeatEval(counter.update(_ + 1)).spaced(1
.second)
     |
-- [E008] Not Found Error: -----------------------------------
------------------
2 |      Stream.repeatEval(counter.update(_ + 1)).spaced(1.sec
ond)
  |                                                      ^^^^^
^^^
  |value second is not a member of Int, but could be made avai
lable as an extension method.
  |
  |The following import might fix the problem:
  |
  |  import scala.concurrent.duration.DurationInt
  |
1 error found

scala> import scala.concurrent.duration.*

scala>     val incrementEverySecond =
     |       Stream.repeatEval(counter.update(_ + 1)).spaced(1
.second)
     |
     |
val incrementEverySecond: fs2.Stream[cats.effect.IO, Unit] = S
tream(..)

scala>     val printOnChange = counter.discrete.evalMap(IO.pri
ntln)
val printOnChange: fs2.Stream[cats.effect.IO, Unit] = Stream(.
.)

scala> Stream(incrementEverySecond, printOnChange).parJoinUnbo
unded
val res2: fs2.Stream[cats.effect.IO, Unit] = Stream(..)


scala> res2.compile.drain.timeout(10.seconds)
val res3: cats.effect.IO[Unit] = IO(...)


scala> res3.unsafeRunSync()
0
1
2
3
4
5
6
7
8
9
10
java.util.concurrent.TimeoutException: 10 seconds
  at timeout @ rs$line$13$.<clinit>(rs$line$13:1)
  at timeout @ rs$line$13$.<clinit>(rs$line$13:1)
  at unsafeRunSync @ rs$line$4$.<clinit>(rs$line$4:2)
  at unsafeRunSync @ rs$line$4$.<clinit>(rs$line$4:2)
  at forceR$extension @ fs2.Stream$NestedStreamOps$.runInner$2
$$anonfun$1$$anonfun$2$$anonfun$3(Stream.scala:4616)

scala> exit
-- [E006] Not Found Error: -----------------------------------
------------------
1 |exit
  |^^^^
  |Not found: exit - did you mean Unit? or perhaps text or wai
t?
  |
  | longer explanation available when compiling with `-explain
`
1 error found

scala> :q
λ> tmux capture-pane -pS - > scaladays-workshop-notes/day2-par
t1.log

