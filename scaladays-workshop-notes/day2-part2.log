-----------------------------------------------
1 |res5.unsafeRunSync()
  |                    ^
  |Could not find an implicit IORuntime.
  |
  |Instead of calling unsafe methods directly, consider using c
ats.effect.IOApp, which
  |runs your IO. If integrating with non-functional code or exp
erimenting in a REPL / Worksheet,
  |add the following import:
  |
  |import cats.effect.unsafe.implicits.global
  |
  |Alternatively, you can create an explicit IORuntime value an
d put it in implicit scope.
  |This may be useful if you have a pre-existing fixed thread p
ool and/or scheduler which you
  |wish to use to execute IO programs. Please be sure to review
 thread pool best practices to
  |avoid unintentionally degrading your application performance
.
  |
  |
  |The following import might fix the problem:
  |
  |  import cats.effect.unsafe.implicits.global
  |
1 error found

scala> import cats.effect.unsafe.implicits.global

scala> res5.unsafeRunSync()
Mao

scala>     Stream.exec(IO.println("Mao"))
     |
val res6: fs2.Stream[cats.effect.IO, Nothing] = Stream(..)

scala> Stream.eval(IO.println("Mao"))
val res7: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> :q
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Mao
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Mao
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig1Effects.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Mao
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
n1
n2
Non-daemon threads currently preventing JVM termination: - 44:
Thread[#44,DestroyJavaVM,5,main]
 -  - 38: Thread[#38,AWT-Shutdown,5,system]
λ> scala-cli repl project.scala

Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM).
Type in expressions for evaluation. Or try :help.


scala>
                                                              s
cala> import fs2.*
     | import cats.effect.*
     |

scala> Stream(1,2,3).debugChunks().compile.toList
Chunk(1, 2, 3)
val res0: List[Int] = List(1, 2, 3)

scala> :q
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Food
Chocolate
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Croissant
Coffee
Water
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Orange
Apple
Banan
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
A
B
C
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
A
B
C
D
E
λ> D
bash: D: command not found
E
λ> E
bash: E: command not found
λ> scala-cli run project.scala scala/WorkshopAquascapeApp.scala
 scala/Part2HandlingSideEffects/Fig5Chunks.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
What is your favourite food?
Chocolate
What is your favourite food?
Chocolate!
What is your favourite food?
CHOCOLATE!!!
λ> scala-cli repl project.scala
Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM).
Type in expressions for evaluation. Or try :help.

scala> Stream("a", "b", "c").reduce
there was 1 deprecation warning; re-run with -deprecation for d
etails
1 warning found
val res0: ((String, String) => String) => String = Lambda/0x000
0000124580c10@2dfab167

scala> import fs2.*

scala> Stream("a", "b", "c").fold
val res1: Any => ((Any, String) => Any) => fs2.Stream[[x] =>> f
s2.Pure[x], Any] = Lambda/0x00000001245e4c10@6ca1c156

scala> Stream("a", "b", "c").fold(0)((prev, text) => prev + 1)

val res2: fs2.Stream[[x] =>> fs2.Pure[x], Int] = Stream(..)

scala> res2.compile.last
val res3: Option[Int] = Some(3)

scala> import cats.effect.IO
     |

scala> import cats.effect.Ref
     | import cats.effect.unsafe.implicits.global
     |

scala> Ref.of[IO, Int](42)
val res4: cats.effect.IO[cats.effect.kernel.Ref[cats.effect.IO,
 Int]] = IO(...)

scala> res4.unsafeRunSync()
val res5: cats.effect.kernel.Ref[cats.effect.IO, Int] = cats.ef
fect.kernel.SyncRef@113773b5

scala> counter = Ref.of[IO, Int](42).unsafeRunSync()
-- [E006] Not Found Error: ------------------------------------
-----------------
1 |counter = Ref.of[IO, Int](42).unsafeRunSync()
  |^^^^^^^
  |Not found: counter
  |
  | longer explanation available when compiling with `-explain`
1 error found

scala> val counter = Ref.of[IO, Int](42).unsafeRunSync()
val counter: cats.effect.kernel.Ref[cats.effect.IO, Int] = cats
.effect.kernel.SyncRef@53339642

scala> counter.get
val res6: cats.effect.IO[Int] = IO(...)

scala> counter.get.unsafeRunSync()
val res7: Int = 42

scala> Ref.of[IO, Int](42)
val res8: cats.effect.IO[cats.effect.kernel.Ref[cats.effect.IO,
 Int]] = IO(...)

scala> Ref.of[IO, Int](42).flatMap(counter => counter.get)
val res9: cats.effect.IO[Int] = IO(...)

scala> res9
val res10: cats.effect.IO[Int] = IO(...)

scala> res9.unsafeRunSync()
val res11: Int = 42

scala> counter
val res12: cats.effect.kernel.Ref[cats.effect.IO, Int] = cats.e
ffect.kernel.SyncRef@53339642

scala> val getIO = counter.get
val getIO: cats.effect.IO[Int] = IO(...)

scala> getIO.unsafeRunSync()
val res13: Int = 42

def set(a: A): F[Unit]

scala> counter.set(33)
val res14: cats.effect.IO[Unit] = IO(...)

scala> getIO.unsafeRunSync()
val res15: Int = 42

scala> counter.set(33).unsafeRunSync()

scala> getIO.unsafeRunSync()
val res16: Int = 33

scala> counter.update(prev => prev + 1)
val res17: cats.effect.IO[Unit] = IO(...)

scala> res17.unsafeRunSync()

scala> getIO.unsafeRunSync()
val res18: Int = 34

scala> res17.unsafeRunSync()

scala> getIO.unsafeRunSync()
val res19: Int = 35

scala>
scala> val incrementEverySecond =
     |   Stream.eval(counter.update(_ + 1))
     |     .repeat.spaced(1.second)
     |

-- [E008] Not Found Error: ------------------------------------
-----------------
3 |    .repeat.spaced(1.second)
  |                   ^^^^^^^^
  |value second is not a member of Int, but could be made avail
able as an extension method.
  |
  |The following import might fix the problem:
  |
  |  import scala.concurrent.duration.DurationInt
  |
1 error found

scala>

scala> import scala.concurrent.duration.*

scala> val incrementEverySecond =
     |   Stream.eval(counter.update(_ + 1))
     |     .repeat.spaced(1.second)
     |
val incrementEverySecond: fs2.Stream[cats.effect.IO, Unit] = St
ream(..)

scala> incrementEverySecond.compile.drain.timeout(5.seconds)
val res20: cats.effect.IO[Unit] = IO(...)

scala> res20.unsafeRunSync()
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)

scala> getIO.unsafeRunSync()
val res22: Int = 40

scala> counter.get.flatMap(IO.println)
val res23: cats.effect.IO[Unit] = IO(...)

scala> res23.unsafeRunSync()
40

scala> val printCountIO = counter.get.flatMap(n => IO.println(s
"The number is $n"))
val printCountIO: cats.effect.IO[Unit] = IO(...)

scala> printCountIO.unsafeRunSync()
The number is 40

scala> Stream.eval(printCountIO).repeat.spaced(500.millis)
val res24: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> res24.compile.drain.timeout(5.seconds)
val res25: cats.effect.IO[Unit] = IO(...)

scala> res25.unsafeRunSync()
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
The number is 40
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)

scala> val printTwicePerSecond =
     |   Stream.eval(printCountIO).repeat.spaced(500.millis)
     |
val printTwicePerSecond: fs2.Stream[cats.effect.IO, Unit] = Str
eam(..)


scala> Stream(incrementEverySecond, printTwicePerSecond).parJoi
nUnbounded
val res27: fs2.Stream[cats.effect.IO, Unit] = Stream(..)


scala> res27.compile.drain.timeout(5.seconds)
val res28: cats.effect.IO[Unit] = IO(...)


scala> res28.unsafeRunSync()
The number is 40
The number is 41
The number is 42
The number is 42
The number is 43
The number is 43
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at timeout @ rs$line$31$.<clinit>(rs$line$31:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)
  at unsafeRunSync @ rs$line$9$.<clinit>(rs$line$9:1)
                                                              s
cala> import fs2.concurrent.*
     |

scala> SignallingRef
     |   .of[IO, Int](0)
     |
val res30: cats.effect.IO[fs2.concurrent.SignallingRef[cats.eff
ect.IO, Int]] = IO(...)

scala> res30.unsafeRunSync()
val res31: fs2.concurrent.SignallingRef[cats.effect.IO, Int] =
fs2.concurrent.SignallingRef$$anon$4@67749a7e

scala> res31.get.unsafeRunSync()

  unhandled exception while running pickler on rs$line$48

  An unhandled exception was thrown in the compiler.
  Please file a crash report here:
  https://github.com/scala/scala3/issues/new/choose
  For non-enriched exceptions, compile with -Xno-enrich-error-m
essages.


     while compiling: rs$line$48
        during phase: pickler
                mode: Mode(ImplicitsEnabled,ReadPositions,Inter
active)
     library version: version 2.13.16
    compiler version: version 3.7.0
            settings: -Xcook-docs true -Xread-docs true -classp
ath /Users/zainab/dev/zainab-ali/functional-stream-processing-w
orkshop/.scala-build/functional-stream-processing-workshop_1628
ab5c8e-f9b87170bb/classes/main:/Users/zainab/Library/Caches/Cou
rsier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala3-lib
rary_3/3.7.0/scala3-library_3-3.7.0.jar:/Users/zainab/Library/C
aches/Coursier/v1/https/repo1.maven.org/maven2/com/github/zaina
b-ali/aquascape_3/0.4.0/aquascape_3-0.4.0.jar:/Users/zainab/Lib
rary/Caches/Coursier/v1/https/repo1.maven.org/maven2/co/fs2/fs2
-core_3/3.12.0/fs2-core_3-3.12.0.jar:/Users/zainab/Library/Cach
es/Coursier/v1/https/repo1.maven.org/maven2/co/fs2/fs2-io_3/3.1
2.0/fs2-io_3-3.12.0.jar:/Users/zainab/Library/Caches/Coursier/v
1/https/repo1.maven.org/maven2/com/lihaoyi/scalatags_3/0.13.1/s
calatags_3-0.13.1.jar:/Users/zainab/Library/Caches/Coursier/v1/
https/repo1.maven.org/maven2/org/scala-lang/scala-library/2.13.
16/scala-library-2.13.16.jar:/Users/zainab/Library/Caches/Cours
ier/v1/https/repo1.maven.org/maven2/org/creativescala/doodle-co
re_3/0.30.0/doodle-core_3-0.30.0.jar:/Users/zainab/Library/Cach
es/Coursier/v1/https/repo1.maven.org/maven2/org/typelevel/cats-
core_3/2.13.0/cats-core_3-2.13.0.jar:/Users/zainab/Library/Cach
es/Coursier/v1/https/repo1.maven.org/maven2/org/typelevel/cats-
effect_3/3.6.1/cats-effect_3-3.6.1.jar:/Users/zainab/Library/Ca
ches/Coursier/v1/https/repo1.maven.org/maven2/org/creativescala
/doodle-java2d_3/0.30.0/doodle-java2d_3-0.30.0.jar:/Users/zaina
b/Library/Caches/Coursier/v1/https/repo1.maven.org/maven2/com/m
onovore/decline_3/2.5.0/decline_3-2.5.0.jar:/Users/zainab/Libra
ry/Caches/Coursier/v1/https/repo1.maven.org/maven2/org/scodec/s
codec-bits_3/1.1.38/scodec-bits_3-1.1.38.jar:/Users/zainab/Libr
ary/Caches/Coursier/v1/https/repo1.maven.org/maven2/com/comcast
/ip4s-core_3/3.6.0/ip4s-core_3-3.6.0.jar:/Users/zainab/Library/
Caches/Coursier/v1/https/repo1.maven.org/maven2/com/lihaoyi/sou
rcecode_3/0.4.0/sourcecode_3-0.4.0.jar:/Users/zainab/Library/Ca
ches/Coursier/v1/https/repo1.maven.org/maven2/com/lihaoyi/geny_
3/1.1.0/geny_3-1.1.0.jar:/Users/zainab/Library/Caches/Coursier/
v1/https/repo1.maven.org/maven2/org/typelevel/cats-free_3/2.13.
0/cats-free_3-2.13.0.jar:/Users/zainab/Library/Caches/Coursier/
v1/https/repo1.maven.org/maven2/org/typelevel/cats-kernel_3/2.1
3.0/cats-kernel_3-2.13.0.jar:/Users/zainab/Library/Caches/Cours
ier/v1/https/repo1.maven.org/maven2/org/typelevel/cats-effect-k
ernel_3/3.6.1/cats-effect-kernel_3-3.6.1.jar:/Users/zainab/Libr
ary/Caches/Coursier/v1/https/repo1.maven.org/maven2/org/typelev
el/cats-effect-std_3/3.6.1/cats-effect-std_3-3.6.1.jar:/Users/z
ainab/Library/Caches/Coursier/v1/https/repo1.maven.org/maven2/o
rg/typelevel/cats-mtl_3/1.3.1/cats-mtl_3-1.3.1.jar:/Users/zaina
b/Library/Caches/Coursier/v1/https/repo1.maven.org/maven2/org/c
reativescala/doodle-algebra_3/0.30.0/doodle-algebra_3-0.30.0.ja
r:/Users/zainab/Library/Caches/Coursier/v1/https/repo1.maven.or
g/maven2/org/creativescala/doodle-interact_3/0.30.0/doodle-inte
ract_3-0.30.0.jar:/Users/zainab/Library/Caches/Coursier/v1/http
s/repo1.maven.org/maven2/de/erichseifert/vectorgraphics2d/Vecto
rGraphics2D/0.13/VectorGraphics2D-0.13.jar:/Users/zainab/Librar
y/Caches/Coursier/v1/https/repo1.maven.org/maven2/org/typelevel
/literally_3/1.1.0/literally_3-1.1.0.jar -d <REPL compilation o
utput>

Exception in thread "main" java.lang.OutOfMemoryError: Java hea
p space
        at dotty.tools.dotc.util.PerfectHashing.allocate(Perfec
tHashing.scala:36)
        at dotty.tools.dotc.util.IntMap.allocate(IntMap.scala:2
9)
        at dotty.tools.dotc.util.PerfectHashing.clear(PerfectHa
shing.scala:45)
        at dotty.tools.dotc.util.PerfectHashing.<init>(PerfectH
ashing.scala:31)
        at dotty.tools.dotc.util.IntMap.<init>(IntMap.scala:23)
        at dotty.tools.dotc.core.tasty.TreeBuffer.<init>(TreeBu
ffer.scala:24)
        at dotty.tools.dotc.core.tasty.TreePickler.<init>(TreeP
ickler.scala:28)
        at dotty.tools.dotc.transform.Pickler.run$$anonfun$1$$a
nonfun$1(Pickler.scala:303)
        at dotty.tools.dotc.transform.Pickler$$Lambda/0x0000000
1244a8000.applyVoid(Unknown Source)
        at scala.runtime.function.JProcedure1.apply(JProcedure1
.java:15)
        at scala.runtime.function.JProcedure1.apply(JProcedure1
.java:10)
        at scala.collection.immutable.List.foreach(List.scala:3
34)
        at dotty.tools.dotc.transform.Pickler.run$$anonfun$1(Pi
ckler.scala:279)
        at dotty.tools.dotc.transform.Pickler$$Lambda/0x0000000
1244a7ae8.applyVoid(Unknown Source)
        at scala.runtime.function.JProcedure1.apply(JProcedure1
.java:15)
        at scala.runtime.function.JProcedure1.apply(JProcedure1
.java:10)
        at scala.collection.immutable.List.foreach(List.scala:3
34)
        at dotty.tools.dotc.transform.Pickler.run(Pickler.scala
:278)
        at dotty.tools.dotc.core.Phases$Phase.runOn$$anonfun$1(
Phases.scala:383)
        at dotty.tools.dotc.core.Phases$Phase$$Lambda/0x0000000
124354408.applyVoid(Unknown Source)
        at scala.runtime.function.JProcedure1.apply(JProcedure1
.java:15)
        at scala.runtime.function.JProcedure1.apply(JProcedure1
.java:10)
        at scala.collection.immutable.List.foreach(List.scala:3
34)
        at dotty.tools.dotc.core.Phases$Phase.runOn(Phases.scal
a:376)
        at dotty.tools.dotc.transform.Pickler.runPhase$1(Pickle
r.scala:392)
        at dotty.tools.dotc.transform.Pickler.runOn(Pickler.sca
la:398)
        at dotty.tools.dotc.Run.runPhases$1$$anonfun$1(Run.scal
a:367)
        at dotty.tools.dotc.Run$$Lambda/0x0000000124354000.appl
yVoid(Unknown Source)
        at scala.runtime.function.JProcedure1.apply(JProcedure1
.java:15)
        at scala.runtime.function.JProcedure1.apply(JProcedure1
.java:10)
        at scala.collection.ArrayOps$.foreach$extension(ArrayOp
s.scala:1324)
        at dotty.tools.dotc.Run.runPhases$1(Run.scala:360)
λ> scala-cli repl project.scala
Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM).
Type in expressions for evaluation. Or try :help.

scala> import fs2.concurrent.*
     |

scala> import cats.effect.IO
     | import cats.effect.Ref
     |

scala> SignallingRef
     |   .of[IO, Int](0).unsafeRunSync()
-- [E172] Type Error: -----------------------------------------
-----------------
2 |  .of[IO, Int](0).unsafeRunSync()
  |                                 ^
  |Could not find an implicit IORuntime.
  |
  |Instead of calling unsafe methods directly, consider using c
ats.effect.IOApp, which
  |runs your IO. If integrating with non-functional code or exp
erimenting in a REPL / Worksheet,
  |add the following import:
  |
  |import cats.effect.unsafe.implicits.global
  |
  |Alternatively, you can create an explicit IORuntime value an
d put it in implicit scope.
  |This may be useful if you have a pre-existing fixed thread p
ool and/or scheduler which you
  |wish to use to execute IO programs. Please be sure to review
 thread pool best practices to
  |avoid unintentionally degrading your application performance
.
  |
  |
  |The following import might fix the problem:
  |
  |  import cats.effect.unsafe.implicits.global
  |
1 error found

scala> import cats.effect.unsafe.implicits.global
     |

scala> SignallingRef
     |   .of[IO, Int](0).unsafeRunSync()
val res0: fs2.concurrent.SignallingRef[cats.effect.IO, Int] = f
s2.concurrent.SignallingRef$$anon$4@4f8efd72

scala> res0.discrete
val res1: fs2.Stream[cats.effect.IO, Int] = Stream(..)

scala> val counter =
     | SignallingRef
     |   .of[IO, Int](0).unsafeRunSync()
val counter: fs2.concurrent.SignallingRef[cats.effect.IO, Int]
= fs2.concurrent.SignallingRef$$anon$4@349c64a1

scala>     val incrementEverySecond =
     |       Stream.repeatEval(counter.update(_ + 1)).spaced(1.
second)
     |
-- [E008] Not Found Error: ------------------------------------
-----------------
2 |      Stream.repeatEval(counter.update(_ + 1)).spaced(1.seco
nd)
  |      ^^^^^^^^^^^^^^^^^
  |value repeatEval is not a member of object scala.collection.
immutable.Stream
1 error found

scala> import fs2.*

scala> val counter =
     | SignallingRef
     |   .of[IO, Int](0).unsafeRunSync()
val counter: fs2.concurrent.SignallingRef[cats.effect.IO, Int]
= fs2.concurrent.SignallingRef$$anon$4@245f90a6

scala>     val incrementEverySecond =
     |       Stream.repeatEval(counter.update(_ + 1)).spaced(1.
second)
     |
-- [E008] Not Found Error: ------------------------------------
-----------------
2 |      Stream.repeatEval(counter.update(_ + 1)).spaced(1.seco
nd)
  |                                                      ^^^^^^
^^
  |value second is not a member of Int, but could be made avail
able as an extension method.
  |
  |The following import might fix the problem:
  |
  |  import scala.concurrent.duration.DurationInt
  |
1 error found

scala> import scala.concurrent.duration.*

scala>     val incrementEverySecond =
     |       Stream.repeatEval(counter.update(_ + 1)).spaced(1.
second)
     |
     |
val incrementEverySecond: fs2.Stream[cats.effect.IO, Unit] = St
ream(..)

scala>     val printOnChange = counter.discrete.evalMap(IO.prin
tln)
val printOnChange: fs2.Stream[cats.effect.IO, Unit] = Stream(..
)

scala> Stream(incrementEverySecond, printOnChange).parJoinUnbou
nded
val res2: fs2.Stream[cats.effect.IO, Unit] = Stream(..)


scala> res2.compile.drain.timeout(10.seconds)
val res3: cats.effect.IO[Unit] = IO(...)


scala> res3.unsafeRunSync()
0
1
2
3
4
5
6
7
8
9
10
java.util.concurrent.TimeoutException: 10 seconds
  at timeout @ rs$line$13$.<clinit>(rs$line$13:1)
  at timeout @ rs$line$13$.<clinit>(rs$line$13:1)
  at unsafeRunSync @ rs$line$4$.<clinit>(rs$line$4:2)
  at unsafeRunSync @ rs$line$4$.<clinit>(rs$line$4:2)
  at forceR$extension @ fs2.Stream$NestedStreamOps$.runInner$2$
$anonfun$1$$anonfun$2$$anonfun$3(Stream.scala:4616)
                                                              s
cala> exit
-- [E006] Not Found Error: ------------------------------------
-----------------
1 |exit
  |^^^^
  |Not found: exit - did you mean Unit? or perhaps text or wait
?
  |
  | longer explanation available when compiling with `-explain`
1 error found

scala> :q
λ> tmux capture-pane -pS - > scaladays-workshop-notes/day2-part
1.log
λ> scala-cli repl project.scala

Welcome to Scala 3.7.0 (21.0.4, Java OpenJDK 64-Bit Server VM).
Type in expressions for evaluation. Or try :help.

scala>

scala> import fs2.*
     | import fs2.concurrent.*
     | import cats.effect.*
     | import cats.effect.unsafe.implicits.global
     | import scala.concurrent.duration.*
     |

scala> Channel.unbounded[IO, String]
     |
val res0: cats.effect.IO[fs2.concurrent.Channel[cats.effect.IO,
 String]] = IO(...)

scala> val channel = Channel.unbounded[IO, String].unsafeRunSyn
c()
val channel: fs2.concurrent.Channel[cats.effect.IO, String] = f
s2.concurrent.Channel$$anon$1@1233f419

scala> channel.send("Chocolate")
val res1: cats.effect.IO[Either[fs2.concurrent.Channel.Closed,
Unit]] = IO(...)

scala> channel.send("Chocolate").unsafeRunSync()
val res2: Either[fs2.concurrent.Channel.Closed, Unit] = Right((
))

scala> channel.stream
val res3: fs2.Stream[cats.effect.IO, String] = Stream(..)

scala> channel.stream.evalMap(text => IO.println(text)).compile
.drain
val res4: cats.effect.IO[Unit] = IO(...)

scala> res4.timeout(4.seconds).unsafeRunSync()
Chocolate
java.util.concurrent.TimeoutException: 4 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)

scala> channel.close
val res6: cats.effect.IO[Either[fs2.concurrent.Channel.Closed,
Unit]] = IO(...)

scala> channel.close.unsafeRunSync()
val res7: Either[fs2.concurrent.Channel.Closed, Unit] = Right((
))

scala> res4.timeout(4.seconds).unsafeRunSync()

scala> res4.compile.toList.unsafeRunSync()
-- [E008] Not Found Error: ------------------------------------
-----------------
1 |res4.compile.toList.unsafeRunSync()
  |^^^^^^^^^^^^
  |value compile is not a member of cats.effect.IO[Unit]
1 error found

scala> channel.stream.evalMap(text => IO.println(text)).compile
.toList.unsafeRunSync()
val res8: List[Unit] = List()

scala> val boundedChannel = Channel.bounded[IO, String](2)
val boundedChannel:
  cats.effect.IO[fs2.concurrent.Channel[cats.effect.IO, String]
] = IO(...)

scala> val boundedChannel = Channel.bounded[IO, String](2).unsa
feRunSync()
val boundedChannel: fs2.concurrent.Channel[cats.effect.IO, Stri
ng] = fs2.concurrent.Channel$$anon$1@7e7c3f0

scala> boundedChannel.send("Chocolate").unsafeRunSync()
val res9: Either[fs2.concurrent.Channel.Closed, Unit] = Right((
))

scala> boundedChannel.send("Chocolate-2").unsafeRunSync()
val res10: Either[fs2.concurrent.Channel.Closed, Unit] = Right(
())

scala> boundedChannel.send("Chocolate-3").timeout(5.seconds).u
nsafeRunSync()
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)

scala> boundedChannel.trySend("Chocolate-3").timeout(5.seconds)
.unsafeRunSync()
val res12: Either[fs2.concurrent.Channel.Closed, Boolean] = Rig
ht(false)

scala> boundedChannel.close.unsafeRunSync()
val res13: Either[fs2.concurrent.Channel.Closed, Unit] = Right(
())

scala> boundedChannel.trySend("Chocolate-3").timeout(5.seconds)
.unsafeRunSync()
val res14: Either[fs2.concurrent.Channel.Closed, Boolean] = Lef
t(fs2.concurrent.Channel$Closed$@95f1b1d)

scala>     val producer =
     |       Stream.range(0, Int.MaxValue)
     |       .evalMap(i => IO.println(s"Producing $i"))
     |       .spaced(1.second)
     |
val producer: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> producer.compile.drain.timeout(5.seconds).unsafeRunSync(
)
Producing 0
Producing 1
Producing 2
Producing 3
Producing 4
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)

def sendAll: fs2.Pipe[F, A, Nothing]

scala> channel.sendAll
val res16: fs2.Pipe[cats.effect.IO, String, Nothing] = fs2.conc
urrent.Channel$$anon$1$$Lambda/0x000000012b7e8a30@4f1b0725

scala> val channel =
    | Channel.unbounded[IO, Int].unsafeRunSync()
     |
val channel: fs2.concurrent.Channel[cats.effect.IO, Int] = fs2.
concurrent.Channel$$anon$1@29167528

scala> channel.sendAll(producer)
-- [E007] Type Mismatch Error: --------------------------------
-----------------
1 |channel.sendAll(producer)
  |                ^^^^^^^^
  |                Found:    (producer : fs2.Stream[cats.effect
.IO, Unit])
  |                Required: fs2.Stream[cats.effect.IO, Int]
  |
  | longer explanation available when compiling with `-explain`
1 error found

scala>     val producer =
     |       Stream.range(0, Int.MaxValue)
     |       .evalMap(i => IO.println(s"Producing $i").as(i))
     |       .spaced(1.second)
     |
val producer: fs2.Stream[cats.effect.IO, Int] = Stream(..)

scala> val producerThroughChannel = channel.sendAll(producer)
val producerThroughChannel: fs2.Stream[cats.effect.IO, Nothing]
 = Stream(..)

scala>     val consumer = channel.stream.evalMap(i => IO.printl
n(s"Consuming $i"))
     |
val consumer: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> Stream(producerThroughChannel, consumer).parJoinUnbounde
d
val res17: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> res17.compile.drain.timeout(5.seconds).unsafeRunSync()
Producing 0
Consuming 0
Producing 1
Consuming 1
Producing 2
Consuming 2
Producing 3
Consuming 3
Producing 4
Consuming 4
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)

scala>     val consumer = channel.stream
     |     .evalMap(i => IO.println(s"Consuming $i"))
     |     .spaced(1.second)
     |
val consumer: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> Stream(producerThroughChannel, consumer).parJoinUnbounde
d
val res19: fs2.Stream[cats.effect.IO, Unit] = Stream(..)


scala> res19.compile.drain.timeout(5.seconds).unsafeRunSync()
Producing 0
Consuming 0
Producing 1
Consuming 1
Producing 2
Consuming 2
Producing 3
Consuming 3
Producing 4
Consuming 4
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)
                                                              s
cala>     val consumer = channel.stream
     |     .evalMap(i => IO.println(s"Consuming $i"))
     |     .spaced(2.second)
     |
val consumer: fs2.Stream[cats.effect.IO, Unit] = Stream(..)


scala> Stream(producerThroughChannel, consumer).parJoinUnbounde
d
val res21: fs2.Stream[cats.effect.IO, Unit] = Stream(..)


scala> res21.compile.drain.timeout(5.seconds).unsafeRunSync()

Producing 0
Consuming 0
Producing 1
Consuming 1
Producing 2
Producing 3
Consuming 2
Producing 4
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)

scala> res21.compile.drain.timeout(5.seconds).unsafeRunSy
scala> res21.compile.drain.timeout(5.seconds).unsafeRunSync()
Producing 0
Consuming 4
Producing 1
Consuming 0
Producing 2
Producing 3
Consuming 1
Producing 4
java.util.concurrent.TimeoutException: 5 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)
scala> val boundedChannel = Channel
     |   .bounded[IO, Int](2)
val boundedChannel: cats.effect.IO[fs2.concurrent.Channel[cats.
effect.IO, Int]] = IO(...)

scala> val boundedChannel = Channel
     |   .bounded[IO, Int](2).unsafeRunSync()
val boundedChannel: fs2.concurrent.Channel[cats.effect.IO, Int]
 = fs2.concurrent.Channel$$anon$1@27442695

scala>     val producer =
     |       boundedChannel.sendAll(
     |         Stream.range(0, Int.MaxValue)
     |       .evalMap(i => IO.println(s"Producing $i").as(i))
     |       .spaced(1.second)
     |       )
     |
     |
val producer: fs2.Stream[cats.effect.IO, Nothing] = Stream(..)

scala>     val consumer = boundedChannel.stream
     |     .evalMap(i => IO.println(s"Consuming $i"))
     |     .spaced(2.second)
     |
val consumer: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> Stream(producer, consumer).parJoinUnbounded.compile.drai
n.timeout(15.seconds).unsafeRunSync()
Producing 0
Consuming 0
Producing 1
Consuming 1
Producing 2
Producing 3
Consuming 2
Producing 4
Producing 5
Consuming 3
Producing 6
Consuming 4
Producing 7
Consuming 5
Producing 8
Producing 9
Consuming 6
Consuming 7
java.util.concurrent.TimeoutException: 15 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)

scala> Stream(producer, consumer).parJoinUnbounded.compile.drai
n.timeout(25.seconds).unsafeRunSync()
Producing 0
Consuming 0
Producing 1
Consuming 1
Producing 2
Producing 3
Consuming 2
Producing 4
Producing 5
Consuming 3
Producing 6
Consuming 4
Producing 7
Consuming 5
Producing 8
Producing 9
Consuming 6
Consuming 7
Producing 10
Consuming 8
Producing 11
Producing 12
Consuming 9
Consuming 10
Producing 13
Consuming 11
Producing 14
Producing 15
Consuming 12
java.util.concurrent.TimeoutException: 25 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)

scala> val boundedChannel = Channel.bounded[IO, Int](5).unsafeR
unSync()
     |
val boundedChannel: fs2.concurrent.Channel[cats.effect.IO, Int]
 = fs2.concurrent.Channel$$anon$1@14897087

scala>     val producer =
     |       boundedChannel.sendAll(
     |         Stream.range(0, Int.MaxValue)
     |       .evalMap(i => IO.println(s"Producing $i").as(i))
     |       .spaced(200.millis)
     |       )
     |
val producer: fs2.Stream[cats.effect.IO, Nothing] = Stream(..)

scala>     val consumer = boundedChannel.stream
     |     .evalMap(i => IO.println(s"Consuming $i"))
     |     .spaced(2.second)
     |
val consumer: fs2.Stream[cats.effect.IO, Unit] = Stream(..)

scala> Stream(producer, consumer).parJoinUnbounded.compile.drai
n.timeout(15.seconds).unsafeRunSync()
Producing 0
Consuming 0
Producing 1
Producing 2
Producing 3
Producing 4
Producing 5
Producing 6
Consuming 1
Producing 7
Producing 8
Producing 9
Producing 10
Producing 11
Producing 12
Consuming 2
Consuming 3
Consuming 4
Consuming 5
Consuming 6
Consuming 7
Producing 13
Producing 14
Producing 15
Producing 16
java.util.concurrent.TimeoutException: 15 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)


scala> Stream(producer, consumer).parJoinUnbounded.compile.drai
n.timeout(15.seconds).unsafeRunSync()
Producing 0
Consuming 13
Producing 1
Producing 2
Producing 3
Producing 4
Producing 5
Consuming 14
Consuming 15
Consuming 16
Consuming 0
Producing 6
Producing 7
Producing 8
Producing 9
Producing 10
Producing 11
Consuming 1
Consuming 2
Consuming 3
java.util.concurrent.TimeoutException: 15 seconds
  at timeout @ rs$line$8$.<clinit>(rs$line$8:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at unsafeRunSync @ rs$line$3$.<clinit>(rs$line$3:1)
  at *>$extension @ fs2.concurrent.Channel$$anon$1.sendImpl$$an
onfun$1$$anonfun$1(Channel.scala:171)

scala> :q
λ> scala-cli run project.scala scala/Part5Application/*.scala
Compiling project (Scala 3.7.0, JVM (21))
[error] ./scala/Part5Application/Game3FruitPicking.scala:18:13
[error] Not found: type GameAppWithErrorAndLoggingAndMetrics
[error]     extends GameAppWithErrorAndLoggingAndMetrics[
[error]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Error compiling project (Scala 3.7.0, JVM (21))
Compilation failed
λ> scala-cli run project.scala scala/Part5Application/Game.scal
a scala/Part5Application/Game
scala/Part5Application/Game.scala
scala/Part5Application/Game1GrowingCircle.scala
scala/Part5Application/Game2ResettingCircle.scala
scala/Part5Application/Game3FruitPicking.scala
λ> scala-cli compike project.scala scala/Part5Application/Game.
scala scala/Part5Application/Game1GrowingCircle.scala
[error]  compike is not a /nix/store/9dm50qbnb02mspzzjs7yl168v8
alh3bs-scala-cli-1.8.0/bin/scala-cli sub-command and it is not
a valid path to an input file or directory.
Try viewing the relevant help to see the list of available sub-
commands and options.
  /nix/store/9dm50qbnb02mspzzjs7yl168v8alh3bs-scala-cli-1.8.0/b
in/scala-cli --help
λ> scala-cli compile project.scala scala/Part5Application/Game.
scala scala/Part5Application/Game1GrowingCircle.scala
Compiling project (Scala 3.7.0, JVM (21))
[error] ./scala/Part5Application/Game1GrowingCircle.scala:12:35
[error] Not found: type GameApp
[error] object Game1GrowingCircle extends GameApp[Int, Unit] {
[error]                                   ^^^^^^^
Error compiling project (Scala 3.7.0, JVM (21))
Compilation failed
λ> scala-cli compile project.scala scala/Part5Application/Game.
scala scala/Part5Application/solution/Game1GrowingCircle.scala
[error]  File not found: /Users/zainab/dev/zainab-ali/functiona
l-stream-processing-workshop/scala/Part5Application/solution/Ga
me1GrowingCircle.scala
λ> scala-cli compile project.scala scala/Part5Application/*.sca
la scala/Part5Application/**/*.scala
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
λ> scala-cli run project.scala scala/Part5Application/*.scala s
cala/Part5Application/**/*.scala
[error]  Found several main classes: Example93, Game1GrowingCir
cle, Game3FruitPicking
You can run one of them by passing it with the --main-class opt
ion, e.g.
  /nix/store/9dm50qbnb02mspzzjs7yl168v8alh3bs-scala-cli-1.8.0/b
in/scala-cli run project.scala scala/Part5Application/Ex1GameAp
p.scala scala/Part5Application/Game.scala scala/Part5Applicatio
n/Game1GrowingCircle.scala scala/Part5Application/Game2Resettin
gCircle.scala scala/Part5Application/Game3FruitPicking.scala sc
ala/Part5Application/Ex1GameApp.scala scala/Part5Application/Ga
me.scala scala/Part5Application/Game1GrowingCircle.scala scala/
Part5Application/Game2ResettingCircle.scala scala/Part5Applicat
ion/Game3FruitPicking.scala scala/Part5Application/solution/Gam
eApp.scala scala/Part5Application/solution/GameAppWithError.sca
la scala/Part5Application/solution/GameAppWithErrorAndLogging.s
cala scala/Part5Application/solution/GameAppWithErrorAndLogging
AndMetrics.scala --main-class Example93

You can pick the main class interactively by passing the --inte
ractive option.
  /nix/store/9dm50qbnb02mspzzjs7yl168v8alh3bs-scala-cli-1.8.0/b
in/scala-cli run project.scala scala/Part5Application/Ex1GameAp
p.scala scala/Part5Application/Game.scala scala/Part5Applicatio
n/Game1GrowingCircle.scala scala/Part5Application/Game2Resettin
gCircle.scala scala/Part5Application/Game3FruitPicking.scala sc
ala/Part5Application/Ex1GameApp.scala scala/Part5Application/Ga
me.scala scala/Part5Application/Game1GrowingCircle.scala scala/
Part5Application/Game2ResettingCircle.scala scala/Part5Applicat
ion/Game3FruitPicking.scala scala/Part5Application/solution/Gam
eApp.scala scala/Part5Application/solution/GameAppWithError.sca
la scala/Part5Application/solution/GameAppWithErrorAndLogging.s
cala scala/Part5Application/solution/GameAppWithErrorAndLogging
AndMetrics.scala --interactive
λ> scala-cli run project.scala scala/Part5Application/*.scala s
cala/Part5Application/**/*.scala --interactive
Found several main classes. Which would you like to run?
[0] Example93
[1] Game1GrowingCircle
[2] Game3FruitPicking
^C
λ> scala-cli run project.scala scala/Part5Application/*.scala s
cala/Part5Application/**/*.scala --interactive
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Found several main classes. Which would you like to run?
[0] Game1GrowingCircle
[1] Game2ResettingCircle
[2] Game3FruitPicking
2
pick
pick
pick
pick
pick
pick
pick
^C^C^C^C^C^C^C^C^C


^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^CKilled: 9
λ> scala-cli run project.scala scala/Part5Application/*.scala s
cala/Part5Application/**/*.scala --interactive
Found several main classes. Which would you like to run?
[0] Game1GrowingCircle
[1] Game2ResettingCircle
[2] Game3FruitPicking
2
pick
pick
pick
pick
pick
pick
pick
pick
pick
pick
pick
pick
pick
pick
pick
pick
pick
λ> scala-cli run project.scala scala/Part5Application/*.scala s
cala/Part5Application/**/*.scala --interactive
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Found several main classes. Which would you like to run?
[0] Game1GrowingCircle
[1] Game2ResettingCircle
[2] Game3FruitPicking
0
^C^C^C^C^KpKilled: 9
λ> scala-cli run project.scala scala/Part5Application/*.scala s
cala/Part5Application/**/*.scala --interactive
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Found several main classes. Which would you like to run?
[0] Game1GrowingCircle
[1] Game2ResettingCircle
[2] Game3FruitPicking
0
^C^C^C

Killed: 9
λ>
λ>
λ> scala-cli run project.scala scala/Part5Application/*.scala s
cala/Part5Application/**/*.scala --interactive
Compiling project (Scala 3.7.0, JVM (21))
Compiled project (Scala 3.7.0, JVM (21))
Found several main classes. Which would you like to run?
[0] Game1GrowingCircle
[1] Game2ResettingCircle
[2] Game3FruitPicking
1
reset
reset
chocolate
reset
reset
reset
^X^X^C^C^C^C^C^C^C^CKilled: 9
λ> tmux capture-pane -pS - > scaladays-workshop-notes/day2-part
2.log

